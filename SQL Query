-- 1. Total revenue generated by sales?
      select sum(total_price) as total_Revenue from pizza_sales;
      
-- 2.  Find Average order Value?
	  select round((sum(total_price)/count(Distinct(order_id))),4) as Avg_order_value from pizza_sales;
       
-- 3.  Total Pizza Orders?
      select count(distinct(order_id)) Total_Pizza_orders from pizza_sales;
      
-- 4. Total Pizza Sold?
      select sum(quantity) as Total_Pizza_sold from pizza_sales;
      
-- 5. Find Average Pizaa per order?
      SELECT CAST(CAST(SUM(quantity) AS DECIMAL(10,2)) / 
	  CAST(COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS DECIMAL(10,2))
	  AS Avg_Pizzas_per_order
      FROM pizza_sales;
      -- #cast is used for coverting datatype and simply we do like below-- 
           SELECT SUM(quantity) / 
           COUNT(DISTINCT order_id)
		   AS Avg_Pizzas_per_order
           FROM pizza_sales;

-- 6. Find Daily Trend for Total Orders?
       SELECT 
    DAYNAME(order_date) AS order_day, 
    COUNT(DISTINCT order_id) AS total_orders
    FROM pizza_sales
    group by dayname(order_date);


-- 7. Hourly trend for Pizza Orders?
    select HOUR(order_time) AS order_hours, 
    COUNT(DISTINCT order_id) AS total_orders
    FROM pizza_sales
    GROUP BY HOUR(order_time)
    ORDER BY order_hours;


-- 8. Percentage of Sales by Pizza category?
   SELECT pizza_category, round(SUM(total_price),3) as total_revenue,
   round(SUM(total_price) * 100 / (SELECT SUM(total_price) from pizza_sales),3) as Percenatge_category
   from pizza_sales
   group by pizza_category;


-- 9. Percenatge of Sales by Pizza Size?
    SELECT pizza_size, round(SUM(total_price),2) as total_revenue,
    round(SUM(total_price) * 100 / (SELECT SUM(total_price) from pizza_sales),2) AS percentage_category
	from pizza_sales
	group by pizza_size
    order by pizza_size;

-- 10. Total Pizza Sold by Category?
       select pizza_category, SUM(quantity) as Total_Quantity_Sold
       from pizza_sales
       group by pizza_category
       order by Total_Quantity_Sold DESC;

-- 11. Top 5 Sellers by total pizza sold?
       select pizza_name, SUM(quantity) AS Total_Pizza_Sold
	   from pizza_sales
       group by pizza_name
	   order by  Total_Pizza_Sold DESC limit 5;

       
-- 12. Last/Bottom 5 Sellers by Total pizza Sold?
        select pizza_name, SUM(quantity) AS Total_Pizza_Sold
	   from pizza_sales
       group by pizza_name
	   order by  Total_Pizza_Sold asc limit 5;
